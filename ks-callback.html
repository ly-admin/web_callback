<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>快手授权回调</title>
</head>
<body>
    <div id="tip">正在处理授权，自动跳转本地服务中...</div>
    <script>
        // 解析URL中的查询参数（code/state）
        function getUrlParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                code: params.get('code'),
                state: params.get('state')
            };
        }

        // 页面加载后执行自动重定向
        window.onload = function () {
            const { code, state } = getUrlParams();
            // 本地后端回调接口地址
            const localApiBase = "http://localhost:8082/kuaishou/auth/callback";

            // 校验授权码是否存在
            if (!code) {
                document.getElementById("tip").innerText = "授权失败：未获取到code参数";
                return;
            }

            // 拼接重定向地址，携带code和state
            let redirectUrl = `${localApiBase}?code=${encodeURIComponent(code)}`;
            if (state) {
                redirectUrl += `&state=${encodeURIComponent(state)}`;
            }

            // 自动跳转到本地后端接口
            window.location.href = redirectUrl;
        };
    </script>
</body>
</html>
